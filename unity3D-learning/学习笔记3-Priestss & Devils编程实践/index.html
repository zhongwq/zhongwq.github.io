



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A site for me to put posts.">
      
      
        <link rel="canonical" href="https://zhongwq.github.io/unity3D-learning/学习笔记3-Priestss & Devils编程实践/">
      
      
        <meta name="author" content="Zhong Wenqian">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.3, mkdocs-material-3.0.4">
    
    
      
        <title>学习笔记3-Priestss & Devils编程实践 - Zhongwq's Site</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#homework2-" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://zhongwq.github.io" title="Zhongwq's Site" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Zhongwq's Site
              </span>
              <span class="md-header-nav__topic">
                学习笔记3-Priestss & Devils编程实践
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://zhongwq.github.io" title="Zhongwq's Site" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Zhongwq's Site
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Unity3D-learning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Unity3D-learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记1-GUI井字棋/" title="学习笔记1-GUI井字棋" class="md-nav__link">
      学习笔记1-GUI井字棋
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记2-物体的空间与运动/" title="学习笔记2-物体的空间与运动" class="md-nav__link">
      学习笔记2-物体的空间与运动
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        学习笔记3-Priestss & Devils编程实践
      </label>
    
    <a href="./" title="学习笔记3-Priestss & Devils编程实践" class="md-nav__link md-nav__link--active">
      学习笔记3-Priestss & Devils编程实践
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="题目要求" class="md-nav__link">
    题目要求
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="简答题：" class="md-nav__link">
    简答题：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="程序限制" class="md-nav__link">
    程序限制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="项目地址" class="md-nav__link">
    项目地址
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unitymvc" title="Unity中的MVC架构" class="md-nav__link">
    Unity中的MVC架构
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uml" title="项目UML图" class="md-nav__link">
    项目UML图
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" title="对各模块分块进行开发" class="md-nav__link">
    对各模块分块进行开发
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gamedirector" title="GameDirector" class="md-nav__link">
    GameDirector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iscenecontroller" title="ISceneController" class="md-nav__link">
    ISceneController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iuseraction" title="IUserAction" class="md-nav__link">
    IUserAction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usergui" title="UserGUI" class="md-nav__link">
    UserGUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clickgui" title="ClickGUI" class="md-nav__link">
    ClickGUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firstcontroller" title="FirstController" class="md-nav__link">
    FirstController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icharactercontroller" title="ICharacterController" class="md-nav__link">
    ICharacterController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boatcontroller" title="BoatController" class="md-nav__link">
    BoatController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#landcontroller" title="LandController" class="md-nav__link">
    LandController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="完整效果" class="md-nav__link">
    完整效果
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvc" title="总结（对MVC架构开发游戏的体会）" class="md-nav__link">
    总结（对MVC架构开发游戏的体会）
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记4-游戏对象与图形基础/" title="学习笔记4-游戏对象与图形基础" class="md-nav__link">
      学习笔记4-游戏对象与图形基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记5-Priests & Devils动作分离版/" title="学习笔记5-Priests & Devils动作分离版" class="md-nav__link">
      学习笔记5-Priests & Devils动作分离版
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记6-Hit UFO编程实践/" title="学习笔记6-Hit UFO编程实践" class="md-nav__link">
      学习笔记6-Hit UFO编程实践
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记7-自定义Component(Editor)/" title="学习笔记7-自定义Component(Editor)" class="md-nav__link">
      学习笔记7-自定义Component(Editor)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记8-adapter模式的打飞碟游戏/" title="学习笔记8-adapter模式的打飞碟游戏" class="md-nav__link">
      学习笔记8-adapter模式的打飞碟游戏
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记9-射箭小游戏/" title="学习笔记9-射箭小游戏" class="md-nav__link">
      学习笔记9-射箭小游戏
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记10-简单巡逻兵小游戏/" title="学习笔记10-简单巡逻兵小游戏" class="md-nav__link">
      学习笔记10-简单巡逻兵小游戏
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记11-粒子光环制作/" title="学习笔记11-粒子光环制作" class="md-nav__link">
      学习笔记11-粒子光环制作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记12-可展开公告版/" title="学习笔记12-可展开公告版" class="md-nav__link">
      学习笔记12-可展开公告版
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记13-AR版的坦克对战/" title="学习笔记13-AR版的坦克对战" class="md-nav__link">
      学习笔记13-AR版的坦克对战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../学习笔记14-网络版坦克大战/" title="学习笔记14-网络版坦克大战" class="md-nav__link">
      学习笔记14-网络版坦克大战
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Leetcode Note
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Leetcode Note
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 327.Count of Range Sum 题解/" title="Leetcode 327题解-Week1" class="md-nav__link">
      Leetcode 327题解-Week1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 315.Count of Smaller Numbers After Self 题解/" title="Leetcode 315题解-Week2" class="md-nav__link">
      Leetcode 315题解-Week2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 45. Jump Game II 题解/" title="Leetcode 45题解-Week3" class="md-nav__link">
      Leetcode 45题解-Week3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 765.Couples Holding Hands 题解/" title="Leetcode 765题解-Week4" class="md-nav__link">
      Leetcode 765题解-Week4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 41. First Missing Positive 题解/" title="Leetcode 41. First Missing Positive-Week5" class="md-nav__link">
      Leetcode 41. First Missing Positive-Week5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 23. merge-k-sorted-lists 题解 - Week6/" title="Leetcode 23. merge-k-sorted-lists 题解-Week6" class="md-nav__link">
      Leetcode 23. merge-k-sorted-lists 题解-Week6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 84. Largest Rectangle in Histogram 题解/" title="Leetcode 84. Largest Rectangle in Histogram 题解-Week7" class="md-nav__link">
      Leetcode 84. Largest Rectangle in Histogram 题解-Week7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 132.Palindrome Partitioning II 题解/" title="Leetcode 132.Palindrome Partitioning II 题解-Week8" class="md-nav__link">
      Leetcode 132.Palindrome Partitioning II 题解-Week8
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 123. Best Time to Buy and Sell Stock III 题解/" title="Leetcode 123. Best Time to Buy and Sell Stock III 题解-Week9" class="md-nav__link">
      Leetcode 123. Best Time to Buy and Sell Stock III 题解-Week9
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 115. Distinct Subsequences 题解/" title="Leetcode 115. Distinct Subsequences 题解-Week10" class="md-nav__link">
      Leetcode 115. Distinct Subsequences 题解-Week10
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 72. Edit Distance 题解/" title="Leetcode 72. Edit Distance 题解-Week11" class="md-nav__link">
      Leetcode 72. Edit Distance 题解-Week11
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 321. Create Maximum Number/" title="Leetcode 321. Create Maximum Number 题解-Week12" class="md-nav__link">
      Leetcode 321. Create Maximum Number 题解-Week12
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 188. Best Time to Buy and Sell Stock IV 题解/" title="Leetcode 188. Best Time to Buy and Sell Stock IV 题解-Week13" class="md-nav__link">
      Leetcode 188. Best Time to Buy and Sell Stock IV 题解-Week13
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Leetcode Note/Leetcode 44. Wildcard Matching 题解/" title="Leetcode 44. Wildcard Matching 题解-Week14" class="md-nav__link">
      Leetcode 44. Wildcard Matching 题解-Week14
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      服务计算
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        服务计算
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ServiceComputingOnCloud/MacOS VirtualBox 配置Ubuntu基本环境/" title="MacOS VirtualBox 配置Ubuntu基本环境" class="md-nav__link">
      MacOS VirtualBox 配置Ubuntu基本环境
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ServiceComputingOnCloud/CentOS Go语言环境安装/" title="CentOS Go语言环境安装" class="md-nav__link">
      CentOS Go语言环境安装
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ServiceComputingOnCloud/Golang版本的 Selpg/" title="Golang版本的 Selpg" class="md-nav__link">
      Golang版本的 Selpg
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ServiceComputingOnCloud/Golang使用Travis CI对项目进行持续集成-初体验/" title="Golang使用Travis CI对项目进行持续集成-初体验" class="md-nav__link">
      Golang使用Travis CI对项目进行持续集成-初体验
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ServiceComputingOnCloud/Github - Travis CI - Docker hub - VPS “不落地”云软件开发流水线实战/" title="Github - Travis CI - Docker hub - VPS “不落地”云软件开发流水线实战" class="md-nav__link">
      Github - Travis CI - Docker hub - VPS “不落地”云软件开发流水线实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ServiceComputingOnCloud/Go-Blog项目体会-使用MOCK服务开发初体验/" title="Go-Blog项目体会-使用MOCK服务开发初体验" class="md-nav__link">
      Go-Blog项目体会-使用MOCK服务开发初体验
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="题目要求" class="md-nav__link">
    题目要求
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" title="简答题：" class="md-nav__link">
    简答题：
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="程序限制" class="md-nav__link">
    程序限制
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" title="项目地址" class="md-nav__link">
    项目地址
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unitymvc" title="Unity中的MVC架构" class="md-nav__link">
    Unity中的MVC架构
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uml" title="项目UML图" class="md-nav__link">
    项目UML图
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" title="对各模块分块进行开发" class="md-nav__link">
    对各模块分块进行开发
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gamedirector" title="GameDirector" class="md-nav__link">
    GameDirector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iscenecontroller" title="ISceneController" class="md-nav__link">
    ISceneController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iuseraction" title="IUserAction" class="md-nav__link">
    IUserAction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usergui" title="UserGUI" class="md-nav__link">
    UserGUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clickgui" title="ClickGUI" class="md-nav__link">
    ClickGUI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firstcontroller" title="FirstController" class="md-nav__link">
    FirstController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#icharactercontroller" title="ICharacterController" class="md-nav__link">
    ICharacterController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#boatcontroller" title="BoatController" class="md-nav__link">
    BoatController
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#landcontroller" title="LandController" class="md-nav__link">
    LandController
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" title="完整效果" class="md-nav__link">
    完整效果
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvc" title="总结（对MVC架构开发游戏的体会）" class="md-nav__link">
    总结（对MVC架构开发游戏的体会）
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="homework2-">Homework2-编程实践</h1>
<h3 id="_1">题目要求</h3>
<ul>
<li>阅读以下游戏脚本</li>
</ul>
<blockquote>
<p>Priests and Devils
Priests and Devils is a puzzle game in which you will help the Priests and Devils to cross the river within the time limit. There are 3 priests and 3 devils at one side of the river. They all want to get to the other side of this river, but there is only one boat and this boat can only carry two persons each time. And there must be one person steering the boat from one side to the other side. In the flash game, you can click on them to move them and click the go button to move the boat to the other direction. If the priests are out numbered by the devils on either side of the river, they get killed and the game is over. You can try it in many &gt; ways. Keep all priests alive! Good luck ！</p>
</blockquote>
<h5 id="_2">简答题：</h5>
<ul>
<li>play the game ( http://www.flash-game.net/game/2535/priests-and-devils.html )</li>
<li>
<p>列出游戏中提及的事物（Objects）
    游戏中提及的事物有</p>
<ul>
<li>魔鬼</li>
<li>牧师</li>
<li>船</li>
<li>两边的岸</li>
<li>河</li>
</ul>
</li>
<li>
<p>用表格列出玩家动作表（规则表），注意，动作越少越好</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>行为</th>
<th>行为条件</th>
</tr>
</thead>
<tbody>
<tr>
<td>牧师／恶魔上船</td>
<td>船上有空位且船在该岸</td>
</tr>
<tr>
<td>开船</td>
<td>船上有人</td>
</tr>
<tr>
<td>牧师/恶魔下船</td>
<td>船有人且靠在岸边</td>
</tr>
<tr>
<td>游戏胜利</td>
<td>6个人都到了对岸</td>
</tr>
<tr>
<td>游戏失败</td>
<td>有一边岸上人数不均</td>
</tr>
</tbody>
</table>
<h5 id="_3">程序限制</h5>
<ul>
<li>请将游戏中对象做成预制</li>
<li>在 GenGameObjects 中创建 长方形、正方形、球 及其色彩代表游戏中的对象。</li>
<li>使用 C# 集合类型 有效组织对象</li>
<li>整个游戏仅 主摄像机 和 一个 Empty 对象， 其他对象必须代码动态生成！！！整个游戏不许出现 Find 游戏对象， SendMessage 这类突破程序结构的 通讯耦合 语句。 违背本条准则，不给分</li>
<li>请使用课件架构图编程，不接受非 MVC 结构程序</li>
<li>注意细节，例如：船未靠岸，牧师与魔鬼上下船运动中，均不能接受用户事件！</li>
</ul>
<hr />
<h3 id="_4">项目地址</h3>
<p><a href="https://github.com/zhongwq/Unity3D-Learning/tree/master/Homework2">github@zhongwq/Unity3D-Learning/Homework2</a></p>
<hr />
<h3 id="unitymvc">Unity中的MVC架构</h3>
<p>想使用一个架构进行开发，我们肯定需要先了解MVC架构如何在基于Unity的游戏的开发中使用。仔细分析Unity中的MVC结构，结合老师上课时所讲的内容，它其实和平时在WEB中常用MVC结构在本质上并没有太大的区别，都是关注点分离(SOC)的体现，是一种成熟的软件设计规范。使用MVC架构去开发我们的软件，可以使得我们在拓展软件功能、改进用户交互的时候，不需要重写大量的业务逻辑代码，减少了我们的代码量，方便了软件的拓展，就如老师所说的：“稳固的MVC框架经得起任意拓展”。</p>
<p>下面我们来谈谈Unity中的MVC架构:</p>
<ul>
<li>M(Model): Unity中，Model就是游戏场景中GameObject、和它们的关系以及后台的数据模型(比如用户信息等)，它们都受到相应的Controller的控制</li>
<li>V(View): View这部分在游戏中起到的是与用户进行交互的功能，它们负责向用户战术游戏结果，处理GUI事件并通过IUserAction接口来与Controller进行交互。</li>
<li>C(Controller): Controller控制着游戏场景中所有的对象，其负责接收来自View的用户的指令并根据用户输入的指令，更新Models以及更新View的状态，其可以被认为是连接Model与View的桥梁。</li>
</ul>
<hr />
<h3 id="uml">项目UML图</h3>
<p>在了解了Unity中MVC的基本架构之后，我们就可以开始进行下面的开发了</p>
<p>按照题目要求的MVC结构，分析游戏的基本结构，得到基本的UML图的结构如下:
    <img alt="UML" src="../../img/GameStructure-hw2.png" /></p>
<h2 id="_5">对各模块分块进行开发</h2>
<hr />
<h3 id="gamedirector">GameDirector</h3>
<p>首先，我们来开发担负着众多职责的GameDirector，在游戏里面，导演(Director)的职责大致如下:</p>
<ul>
<li>获取当前游戏的场景</li>
<li>控制场景运行、切换、入栈与出栈，暂停、恢复、退出</li>
<li>管理游戏全局状态</li>
<li>设定游戏的配置</li>
<li>设定游戏全局视图</li>
</ul>
<p>由上我们可知，GameDirector对于一个游戏是多么的重要，但是，在我们这次的小项目中，它的职责没有那么多，它在这次的项目中主要负责的是获取当前游戏场景，其代码如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">GameDirector</span> <span class="p">:</span> <span class="n">System</span><span class="p">.</span><span class="n">Object</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="n">GameDirector</span> <span class="n">_instance</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">ISceneController</span> <span class="n">currentSceneController</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="n">running</span> <span class="p">{</span> <span class="k">set</span><span class="p">;</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">GameDirector</span> <span class="nf">getInstance</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_instance</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_instance</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GameDirector</span><span class="p">();</span>
            <span class="k">return</span> <span class="n">_instance</span><span class="p">;</span>
        <span class="p">}</span> 
        <span class="k">return</span> <span class="n">_instance</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getFPS</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Application</span><span class="p">.</span><span class="n">targetFrameRate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">setFPS</span><span class="p">(</span><span class="kt">int</span> <span class="n">fps</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Application</span><span class="p">.</span><span class="n">targetFrameRate</span> <span class="p">=</span> <span class="n">fps</span><span class="p">;</span>        
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Director在运行时只会有一个实例在运行，在上面的代码中，我们可以看到其应用了单例模式保证只有一个实例生成，方便了类之间的事件通信，方便了MVC的实现。</p>
<p>Director作为游戏最为高层的Controller，其不具体的控制游戏中的任一对象，其通过对currentSceneController的维护，把控制游戏对象的任务交给不同的SceneController。</p>
<hr />
<h3 id="iscenecontroller">ISceneController</h3>
<p>ISceneController的代码如下</p>
<div class="codehilite"><pre><span></span><span class="c1">//interface of Scene</span>

<span class="k">public</span> <span class="k">interface</span> <span class="n">ISceneController</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">genGameObjects</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>


<p>ISCeneController是游戏中的场景管理器，俗称场记，其主要职责如下:</p>
<ul>
<li>管理游戏在该游戏场景中的所有的游戏对象</li>
<li>协调游戏对象、游戏对象管理器(GameObjectControllers)之间的通信</li>
<li>响应外部输入事件</li>
<li>管理该游戏场景的所有的规则</li>
<li>管理一些其他的东西</li>
</ul>
<p>该统一的接口的实现正是GameDirector对各个游戏场景管理的关键，他是导演控制场景的渠道，GameDirector通过对于currentSceneController的维护，可以简单实现游戏场景的各种管理</p>
<hr />
<h3 id="iuseraction">IUserAction</h3>
<p>IUserAction中体现了游戏编程的门面模式，游戏外部与一个子系统的通信必须通过一个统一的门面对象进行，而我们现在实现的IUserAction就是这样的一个对象,GUI类通过IUserAction来与Controller进行通信，我们通过实现IUserAction接口来定义Controller与GUI的交互，这样我们在实现Controller类时只需要实现IUserAction对应的接口，他就可以与任意使用IUserAction接口的View即GUI类调用，GUI类也是只需调用接口中的方法即可实现与Controller的通信, 方便了我们MVC架构的实现。</p>
<p>其定义如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">interface</span> <span class="n">IUserAction</span> <span class="p">{</span>
    <span class="k">void</span> <span class="nf">restart</span><span class="p">();</span>
    <span class="k">void</span> <span class="nf">ToggleBoat</span><span class="p">();</span>
    <span class="k">void</span> <span class="nf">ClickCharacter</span><span class="p">(</span><span class="n">ICharacterController</span> <span class="n">chracter</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<hr />
<h3 id="usergui">UserGUI</h3>
<p>UserGUI的代码如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">UserGUI</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">status</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">IUserAction</span> <span class="n">action</span><span class="p">;</span>
    <span class="n">GUIStyle</span> <span class="n">headerStyle</span><span class="p">;</span>
    <span class="n">GUIStyle</span> <span class="n">buttonStyle</span><span class="p">;</span>

    <span class="c1">// Use this for initialization</span>
    <span class="k">void</span> <span class="nf">Start</span> <span class="p">()</span> <span class="p">{</span>
        <span class="n">action</span> <span class="p">=</span> <span class="n">GameDirector</span><span class="p">.</span><span class="n">getInstance</span><span class="p">().</span><span class="n">currentSceneController</span> <span class="k">as</span> <span class="n">IUserAction</span><span class="p">;</span>
        <span class="n">headerStyle</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GUIStyle</span><span class="p">();</span>
        <span class="n">headerStyle</span><span class="p">.</span><span class="n">fontSize</span> <span class="p">=</span> <span class="m">40</span><span class="p">;</span>
        <span class="n">headerStyle</span><span class="p">.</span><span class="n">alignment</span> <span class="p">=</span> <span class="n">TextAnchor</span><span class="p">.</span><span class="n">MiddleCenter</span><span class="p">;</span>
        <span class="n">buttonStyle</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GUIStyle</span><span class="p">(</span><span class="s">&quot;button&quot;</span><span class="p">);</span>
        <span class="n">buttonStyle</span><span class="p">.</span><span class="n">fontSize</span> <span class="p">=</span> <span class="m">30</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Update is called once per frame</span>
    <span class="k">void</span> <span class="nf">OnGUI</span> <span class="p">()</span> <span class="p">{</span>
        <span class="n">GUI</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="k">new</span> <span class="n">Rect</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">width</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">100</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">200</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="s">&quot;Priests &amp; Demons&quot;</span><span class="p">,</span> <span class="n">headerStyle</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">GUI</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="k">new</span> <span class="n">Rect</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">width</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">45</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">height</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">90</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="s">&quot;Gameover!&quot;</span><span class="p">,</span> <span class="n">headerStyle</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">GUI</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="k">new</span> <span class="n">Rect</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">width</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">65</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">height</span> <span class="p">/</span> <span class="m">2</span><span class="p">,</span> <span class="m">140</span><span class="p">,</span> <span class="m">70</span><span class="p">),</span> <span class="s">&quot;Restart&quot;</span><span class="p">,</span> <span class="n">buttonStyle</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">status</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">action</span><span class="p">.</span><span class="n">restart</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">2</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">GUI</span><span class="p">.</span><span class="n">Label</span><span class="p">(</span><span class="k">new</span> <span class="n">Rect</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">width</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">50</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">height</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">90</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="s">&quot;Win!&quot;</span><span class="p">,</span> <span class="n">headerStyle</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">GUI</span><span class="p">.</span><span class="n">Button</span><span class="p">(</span><span class="k">new</span> <span class="n">Rect</span><span class="p">(</span><span class="n">Screen</span><span class="p">.</span><span class="n">width</span> <span class="p">/</span> <span class="m">2</span> <span class="p">-</span> <span class="m">70</span><span class="p">,</span> <span class="n">Screen</span><span class="p">.</span><span class="n">height</span> <span class="p">/</span> <span class="m">2</span><span class="p">,</span> <span class="m">140</span><span class="p">,</span> <span class="m">70</span><span class="p">),</span> <span class="s">&quot;Restart&quot;</span><span class="p">,</span> <span class="n">buttonStyle</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">status</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">action</span><span class="p">.</span><span class="n">restart</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>由上我们可以看到，UserGUI只是简单地根据游戏状态，对游戏信息等进行展示，然后通过IUserAction与Controller进行交互，这也是我们在上面所提到的，我们只需要在GUI中调用IUserAction中的方法就可以迅速实现对游戏场景的控制，下面的ClickGUI也是一样</p>
<hr />
<h3 id="clickgui">ClickGUI</h3>
<p>该类的代码如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ClickGUI</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="n">IUserAction</span> <span class="n">action</span><span class="p">;</span>
    <span class="n">ICharacterController</span> <span class="n">character</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">setController</span><span class="p">(</span><span class="n">ICharacterController</span> <span class="n">characterController</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">character</span> <span class="p">=</span> <span class="n">characterController</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">action</span> <span class="p">=</span> <span class="n">GameDirector</span><span class="p">.</span><span class="n">getInstance</span><span class="p">().</span><span class="n">currentSceneController</span> <span class="k">as</span> <span class="n">IUserAction</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">OnMouseDown</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">gameObject</span><span class="p">.</span><span class="n">name</span> <span class="p">==</span> <span class="s">&quot;boat&quot;</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">action</span><span class="p">.</span><span class="n">ToggleBoat</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">action</span><span class="p">.</span><span class="n">ClickCharacter</span><span class="p">(</span><span class="n">character</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>在ClickGUI中，我们同样用到了IUserAction, ClickGUI监听事件的发生，然后通过IUserAction提供的类似移动船，游戏角色上下船的函数，把用户指令传给Controller进行执行。从而实现View和Controller之间的交互。</p>
<hr />
<h3 id="firstcontroller">FirstController</h3>
<p>在该游戏中，只有一个游戏场景，所以</p>
<p>其代码实现如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">FirstController</span> <span class="p">:</span> <span class="n">MonoBehaviour</span><span class="p">,</span> <span class="n">ISceneController</span><span class="p">,</span> <span class="n">IUserAction</span> <span class="p">{</span>
    <span class="k">readonly</span> <span class="n">Vector3</span> <span class="n">riverPosition</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="p">-</span><span class="m">0.25f</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
    <span class="n">UserGUI</span> <span class="n">userGUI</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">LandController</span> <span class="n">rightLand</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">LandController</span> <span class="n">leftLand</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">BoatController</span> <span class="n">boat</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">ICharacterController</span><span class="p">[]</span> <span class="n">characters</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Awake</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">GameDirector</span> <span class="n">director</span> <span class="p">=</span> <span class="n">GameDirector</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
        <span class="n">director</span><span class="p">.</span><span class="n">currentSceneController</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="n">userGUI</span> <span class="p">=</span> <span class="n">gameObject</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">&lt;</span><span class="n">UserGUI</span><span class="p">&gt;()</span> <span class="k">as</span> <span class="n">UserGUI</span><span class="p">;</span>
        <span class="n">genGameObjects</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">genGameObjects</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">characters</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">[</span><span class="m">6</span><span class="p">];</span>
        <span class="n">GameObject</span> <span class="n">river</span> <span class="p">=</span> <span class="n">Instantiate</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&quot;Prefabs/River&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameObject</span><span class="p">)),</span> <span class="n">riverPosition</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">GameObject</span><span class="p">;</span>
        <span class="n">river</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">&quot;river&quot;</span><span class="p">;</span>

        <span class="n">boat</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BoatController</span><span class="p">();</span>
        <span class="n">leftLand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">LandController</span><span class="p">(-</span><span class="m">1</span><span class="p">);</span>
        <span class="n">rightLand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">LandController</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">ICharacterController</span> <span class="n">priest</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">&quot;priest&quot;</span> <span class="p">+</span> <span class="n">i</span><span class="p">);</span>
            <span class="n">priest</span><span class="p">.</span><span class="n">setPosition</span><span class="p">(</span><span class="n">rightLand</span><span class="p">.</span><span class="n">getEmptyPosition</span><span class="p">());</span>
            <span class="n">priest</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="n">rightLand</span><span class="p">);</span>
            <span class="n">rightLand</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="n">priest</span><span class="p">);</span>
            <span class="n">characters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="n">priest</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">3</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">ICharacterController</span> <span class="n">demon</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="s">&quot;demon&quot;</span> <span class="p">+</span> <span class="n">i</span><span class="p">);</span>
            <span class="n">demon</span><span class="p">.</span><span class="n">setPosition</span><span class="p">(</span><span class="n">rightLand</span><span class="p">.</span><span class="n">getEmptyPosition</span><span class="p">());</span>
            <span class="n">demon</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="n">rightLand</span><span class="p">);</span>
            <span class="n">rightLand</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="n">demon</span><span class="p">);</span>
            <span class="n">characters</span><span class="p">[</span><span class="n">i</span><span class="p">+</span><span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="n">demon</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">void</span> <span class="nf">ClickCharacter</span><span class="p">(</span><span class="n">ICharacterController</span> <span class="n">character</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">userGUI</span><span class="p">.</span><span class="n">status</span> <span class="p">!=</span> <span class="m">0</span> <span class="p">||</span> <span class="p">!</span><span class="n">boat</span><span class="p">.</span><span class="n">available</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">character</span><span class="p">.</span><span class="n">isOnBoat</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">LandController</span> <span class="n">land</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">boat</span><span class="p">.</span><span class="n">getBoatPos</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">land</span> <span class="p">=</span> <span class="n">leftLand</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">land</span> <span class="p">=</span> <span class="n">rightLand</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">boat</span><span class="p">.</span><span class="n">getOffBoat</span><span class="p">(</span><span class="n">character</span><span class="p">.</span><span class="n">getName</span><span class="p">());</span>
            <span class="n">character</span><span class="p">.</span><span class="n">MoveTo</span><span class="p">(</span><span class="n">land</span><span class="p">.</span><span class="n">getEmptyPosition</span><span class="p">());</span>
            <span class="n">character</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="n">land</span><span class="p">);</span>
            <span class="n">land</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="n">character</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">LandController</span> <span class="n">land</span> <span class="p">=</span> <span class="n">character</span><span class="p">.</span><span class="n">getLandController</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">boat</span><span class="p">.</span><span class="n">getEmptyIndex</span><span class="p">()</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">landPos</span> <span class="p">=</span> <span class="n">land</span><span class="p">.</span><span class="n">getType</span><span class="p">(),</span> <span class="n">boatPos</span> <span class="p">=</span> <span class="p">(</span><span class="n">boat</span><span class="p">.</span><span class="n">getBoatPos</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">?</span> <span class="p">-</span><span class="m">1</span> <span class="p">:</span> <span class="m">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">landPos</span> <span class="p">!=</span> <span class="n">boatPos</span><span class="p">)</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="n">land</span><span class="p">.</span><span class="n">getOffLand</span><span class="p">(</span><span class="n">character</span><span class="p">.</span><span class="n">getName</span><span class="p">());</span>
            <span class="n">character</span><span class="p">.</span><span class="n">MoveTo</span><span class="p">(</span><span class="n">boat</span><span class="p">.</span><span class="n">getEmptyPosition</span><span class="p">());</span>
            <span class="n">character</span><span class="p">.</span><span class="n">getOnBoat</span><span class="p">(</span><span class="n">boat</span><span class="p">,</span> <span class="n">boat</span><span class="p">.</span><span class="n">getEmptyIndex</span><span class="p">());</span>
            <span class="n">boat</span><span class="p">.</span><span class="n">getOnBoat</span><span class="p">(</span><span class="n">character</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">userGUI</span><span class="p">.</span><span class="n">status</span> <span class="p">=</span> <span class="n">checkResult</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">ToggleBoat</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">userGUI</span><span class="p">.</span><span class="n">status</span> <span class="p">!=</span> <span class="m">0</span> <span class="p">||</span> <span class="n">boat</span><span class="p">.</span><span class="n">isEmptty</span><span class="p">())</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="n">boat</span><span class="p">.</span><span class="n">Move</span><span class="p">();</span>
        <span class="n">userGUI</span><span class="p">.</span><span class="n">status</span> <span class="p">=</span> <span class="n">checkResult</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="nf">checkResult</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">leftPriests</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">rightPriests</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">leftDemons</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">rightDemons</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="kt">int</span><span class="p">[]</span> <span class="n">leftStatus</span> <span class="p">=</span> <span class="n">leftLand</span><span class="p">.</span><span class="n">getStatus</span><span class="p">();</span>
        <span class="n">leftPriests</span> <span class="p">+=</span> <span class="n">leftStatus</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
        <span class="n">leftDemons</span> <span class="p">+=</span> <span class="n">leftStatus</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">leftPriests</span> <span class="p">+</span> <span class="n">leftDemons</span> <span class="p">==</span> <span class="m">6</span><span class="p">)</span>
            <span class="k">return</span> <span class="m">2</span><span class="p">;</span>

        <span class="kt">int</span><span class="p">[]</span> <span class="n">rightStatus</span> <span class="p">=</span> <span class="n">rightLand</span><span class="p">.</span><span class="n">getStatus</span><span class="p">();</span>
        <span class="n">rightPriests</span> <span class="p">+=</span> <span class="n">rightStatus</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
        <span class="n">rightDemons</span> <span class="p">+=</span> <span class="n">rightStatus</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>

        <span class="kt">int</span><span class="p">[]</span> <span class="n">boatStatus</span> <span class="p">=</span> <span class="n">boat</span><span class="p">.</span><span class="n">getBoatStatus</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">boat</span><span class="p">.</span><span class="n">getBoatPos</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">leftPriests</span> <span class="p">+=</span> <span class="n">boatStatus</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
            <span class="n">leftDemons</span> <span class="p">+=</span> <span class="n">boatStatus</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">rightPriests</span> <span class="p">+=</span> <span class="n">boatStatus</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
            <span class="n">rightDemons</span> <span class="p">+=</span> <span class="n">boatStatus</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">leftPriests</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">leftPriests</span> <span class="p">&lt;</span> <span class="n">leftDemons</span><span class="p">)</span>
            <span class="k">return</span> <span class="m">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rightPriests</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">&amp;&amp;</span> <span class="n">rightPriests</span> <span class="p">&lt;</span> <span class="n">rightDemons</span><span class="p">)</span>
            <span class="k">return</span> <span class="m">1</span><span class="p">;</span>

        <span class="k">return</span> <span class="m">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">restart</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">boat</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
        <span class="n">leftLand</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
        <span class="n">rightLand</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characters</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="n">characters</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">reset</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>FirstController继承了ISceneController和IUserAction这两个接口，并实现了其里面的函数，其既可以通过IUserAction与View进行交互，也可以在LoadResources后，通过GameObject的Controller对场景中的各个GameObject进行控制。</p>
<hr />
<p>下面我们来介绍游戏中游戏对象的Controller的书写</p>
<p>首先，贯穿着我们这整一个游戏的就是GameObject的移动啦！所以我先说一下抽象出来的Move类，其代码如下：</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">Move</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
    <span class="k">readonly</span> <span class="kt">float</span> <span class="n">speed</span> <span class="p">=</span> <span class="m">20</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">status</span><span class="p">;</span><span class="c1">//0: 静止, 1: 处于前段移动, 2: 处于后段移动</span>
    <span class="n">Vector3</span> <span class="n">middle</span><span class="p">;</span>
    <span class="n">Vector3</span> <span class="n">destination</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">MoveTowards</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">middle</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span> <span class="p">*</span> <span class="n">speed</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">==</span> <span class="n">middle</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">status</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">2</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">MoveTowards</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span> <span class="p">*</span> <span class="n">speed</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">==</span> <span class="n">destination</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">status</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getStatus</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span>  <span class="k">void</span> <span class="nf">moveTo</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">_destination</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">destination</span> <span class="p">=</span> <span class="n">_destination</span><span class="p">;</span>
        <span class="n">middle</span> <span class="p">=</span> <span class="n">_destination</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_destination</span><span class="p">.</span><span class="n">y</span> <span class="p">==</span> <span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">status</span> <span class="p">=</span> <span class="m">2</span><span class="p">;</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">_destination</span><span class="p">.</span><span class="n">y</span> <span class="p">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">middle</span><span class="p">.</span><span class="n">y</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">middle</span><span class="p">.</span><span class="n">x</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">status</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">reset</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">status</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>为了让物体不要直接穿过land的墙体，当character上船时，先把物体移动到destination的对应的x坐标，然后再把物体移动到对应的位置，当charcter下船时，先把物体移动到destination的对应的y坐标，然后再把物体移动到对应的位置,这样保证了物体不会穿越墙体进行移动，且实现方式较为简单。</p>
<h3 id="icharactercontroller">ICharacterController</h3>
<p>因为牧师与恶魔的动作等都是一样的，就只是外形、类型不一样，所以我把其抽象为一个Controller,通过type区分它们
其代码如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ICharacterController</span>
<span class="p">{</span>
    <span class="k">readonly</span> <span class="n">GameObject</span> <span class="n">character</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="n">Move</span> <span class="n">moveAction</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="kt">int</span> <span class="n">type</span><span class="p">;</span><span class="c1">//0: Priest, 1: Demon</span>
    <span class="k">readonly</span> <span class="n">ClickGUI</span> <span class="n">clickGUI</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="n">onBoat</span><span class="p">;</span>
    <span class="n">LandController</span> <span class="n">landController</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">ICharacterController</span><span class="p">(</span><span class="kt">int</span> <span class="n">chracterType</span><span class="p">,</span> <span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">chracterType</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">character</span> <span class="p">=</span> <span class="n">Object</span><span class="p">.</span><span class="n">Instantiate</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&quot;Prefabs/Priest&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameObject</span><span class="p">)),</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">GameObject</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">type</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">character</span> <span class="p">=</span> <span class="n">Object</span><span class="p">.</span><span class="n">Instantiate</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&quot;Prefabs/Demon&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameObject</span><span class="p">)),</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">GameObject</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">type</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">character</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="n">moveAction</span> <span class="p">=</span> <span class="n">character</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Move</span><span class="p">))</span> <span class="k">as</span> <span class="n">Move</span><span class="p">;</span>
        <span class="n">clickGUI</span> <span class="p">=</span> <span class="n">character</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ClickGUI</span><span class="p">))</span> <span class="k">as</span> <span class="n">ClickGUI</span><span class="p">;</span>
        <span class="n">clickGUI</span><span class="p">.</span><span class="n">setController</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="nf">getName</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">character</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">setPosition</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">pos</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="n">pos</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">MoveTo</span><span class="p">(</span><span class="n">Vector3</span> <span class="n">destination</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">moveAction</span><span class="p">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">destination</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getType</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">type</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">getOnBoat</span><span class="p">(</span><span class="n">BoatController</span> <span class="n">boatController</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">landController</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">AngleAxis</span><span class="p">(</span><span class="m">90</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">AngleAxis</span><span class="p">(</span><span class="m">270</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">parent</span> <span class="p">=</span> <span class="n">boatController</span><span class="p">.</span><span class="n">getBoat</span><span class="p">().</span><span class="n">transform</span><span class="p">;</span>
        <span class="n">onBoat</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">getOnLand</span><span class="p">(</span><span class="n">LandController</span> <span class="n">land</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">landController</span> <span class="p">=</span> <span class="n">land</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">land</span><span class="p">.</span><span class="n">getType</span><span class="p">()</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">AngleAxis</span><span class="p">(</span><span class="m">90</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">AngleAxis</span><span class="p">(</span><span class="m">270</span><span class="p">,</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">up</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">character</span><span class="p">.</span><span class="n">transform</span><span class="p">.</span><span class="n">parent</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="n">onBoat</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">isOnBoat</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">onBoat</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">LandController</span> <span class="nf">getLandController</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">landController</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">reset</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">moveAction</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
        <span class="n">landController</span> <span class="p">=</span> <span class="p">(</span><span class="n">GameDirector</span><span class="p">.</span><span class="n">getInstance</span><span class="p">().</span><span class="n">currentSceneController</span> <span class="k">as</span> <span class="n">FirstController</span><span class="p">).</span><span class="n">rightLand</span><span class="p">;</span>
        <span class="n">getOnLand</span><span class="p">(</span><span class="n">landController</span><span class="p">);</span>
        <span class="n">setPosition</span><span class="p">(</span><span class="n">landController</span><span class="p">.</span><span class="n">getEmptyPosition</span><span class="p">());</span>
        <span class="n">landController</span><span class="p">.</span><span class="n">getOnLand</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>CharcterController类的实现十分简单，就是根据type导入预制，然后再实现上船，上岸，重置以及一些其他的get, set函数就完成了，具体可以看以上代码的实现。</p>
<h3 id="boatcontroller">BoatController</h3>
<p>BoatController类的代码如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">BoatController</span> <span class="p">{</span>
    <span class="k">readonly</span> <span class="n">GameObject</span> <span class="n">boat</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="n">Move</span> <span class="n">moveAction</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="n">Vector3</span> <span class="n">right</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">3.5f</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
    <span class="k">readonly</span> <span class="n">Vector3</span> <span class="n">left</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(-</span><span class="m">3.5f</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
    <span class="k">readonly</span> <span class="n">Vector3</span><span class="p">[]</span> <span class="n">right_positions</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="n">Vector3</span><span class="p">[]</span> <span class="n">left_positions</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">status</span><span class="p">;</span><span class="c1">// 0: left, 1: right</span>
    <span class="n">ICharacterController</span><span class="p">[]</span> <span class="n">characterOnBoat</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">[</span><span class="m">2</span><span class="p">];</span>

    <span class="k">public</span> <span class="nf">BoatController</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">status</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
        <span class="n">right_positions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">[]</span> <span class="p">{</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">2.5F</span><span class="p">,</span> <span class="m">0.2F</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">4.5F</span><span class="p">,</span> <span class="m">0.2F</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="p">};</span>
        <span class="n">left_positions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">[]</span> <span class="p">{</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(-</span><span class="m">4.5F</span><span class="p">,</span> <span class="m">0.2F</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(-</span><span class="m">2.5F</span><span class="p">,</span> <span class="m">0.2F</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="p">};</span>
        <span class="n">boat</span> <span class="p">=</span> <span class="n">Object</span><span class="p">.</span><span class="n">Instantiate</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&quot;Prefabs/Boat&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameObject</span><span class="p">)),</span> <span class="n">right</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">GameObject</span><span class="p">;</span>
        <span class="n">boat</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">&quot;boat&quot;</span><span class="p">;</span>
        <span class="n">moveAction</span> <span class="p">=</span> <span class="n">boat</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Move</span><span class="p">))</span> <span class="k">as</span> <span class="n">Move</span><span class="p">;</span>
        <span class="n">boat</span><span class="p">.</span><span class="n">AddComponent</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">ClickGUI</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Move</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">moveAction</span><span class="p">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">left</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">moveAction</span><span class="p">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">right</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">status</span> <span class="p">=</span> <span class="m">1</span> <span class="p">-</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getEmptyIndex</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnBoat</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">Vector3</span> <span class="nf">getEmptyPosition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">index</span> <span class="p">=</span> <span class="n">getEmptyIndex</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">left_positions</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">right_positions</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">isEmptty</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnBoat</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">getOnBoat</span><span class="p">(</span><span class="n">ICharacterController</span> <span class="n">character</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">characterOnBoat</span><span class="p">[</span><span class="n">getEmptyIndex</span><span class="p">()]</span> <span class="p">=</span> <span class="n">character</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">ICharacterController</span> <span class="nf">getOffBoat</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnBoat</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">getName</span><span class="p">()</span> <span class="p">==</span> <span class="n">name</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">ICharacterController</span> <span class="n">character</span> <span class="p">=</span> <span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">character</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">GameObject</span> <span class="nf">getBoat</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">boat</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getBoatPos</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span><span class="p">[]</span> <span class="nf">getBoatStatus</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span><span class="p">[]</span> <span class="n">boatStatus</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span> <span class="p">};</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnBoat</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="n">boatStatus</span><span class="p">[</span><span class="n">characterOnBoat</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">getType</span><span class="p">()]++;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">boatStatus</span><span class="p">;</span>
    <span class="p">}</span><span class="c1">// 0: Priests, 1: Demon</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="nf">available</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">moveAction</span><span class="p">.</span><span class="n">getStatus</span><span class="p">()</span> <span class="p">==</span> <span class="m">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">reset</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">moveAction</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Move</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">characterOnBoat</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">[</span><span class="m">2</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Boat的实现也差不多，只需要实现初始化、移动(ToggleBoat),character上船、下船相关的函数就可以实现了。</p>
<h3 id="landcontroller">LandController</h3>
<p>LandController类的代码如下:</p>
<div class="codehilite"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">LandController</span> <span class="p">{</span>
    <span class="k">readonly</span> <span class="n">GameObject</span> <span class="n">land</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="n">Vector3</span> <span class="n">leftPos</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(-</span><span class="m">8.5f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>
    <span class="k">readonly</span> <span class="n">Vector3</span> <span class="n">rightPos</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">8.5f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>
    <span class="k">readonly</span> <span class="n">Vector3</span><span class="p">[]</span> <span class="n">landPositions</span><span class="p">;</span>
    <span class="k">readonly</span> <span class="kt">int</span> <span class="n">type</span><span class="p">;</span><span class="c1">// 1:right, -1: left</span>

    <span class="n">ICharacterController</span><span class="p">[]</span> <span class="n">characterOnLand</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">LandController</span><span class="p">(</span><span class="kt">int</span> <span class="n">_type</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">landPositions</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">[]</span> <span class="p">{</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">6F</span><span class="p">,</span><span class="m">0.5F</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">7F</span><span class="p">,</span><span class="m">0.5F</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">8F</span><span class="p">,</span><span class="m">0.5F</span><span class="p">,</span><span class="m">0</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">Vector3</span><span class="p">(</span><span class="m">9F</span><span class="p">,</span><span class="m">0.5F</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">10F</span><span class="p">,</span><span class="m">0.5F</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="k">new</span> <span class="n">Vector3</span><span class="p">(</span><span class="m">11F</span><span class="p">,</span><span class="m">0.5F</span><span class="p">,</span><span class="m">0</span><span class="p">)</span> <span class="p">};</span>

        <span class="n">characterOnLand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">[</span><span class="m">6</span><span class="p">];</span>

        <span class="n">type</span> <span class="p">=</span> <span class="n">_type</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">land</span> <span class="p">=</span> <span class="n">Object</span><span class="p">.</span><span class="n">Instantiate</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&quot;Prefabs/Land&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameObject</span><span class="p">)),</span> <span class="n">rightPos</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">GameObject</span><span class="p">;</span>
            <span class="n">land</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">&quot;rightLand&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">land</span> <span class="p">=</span> <span class="n">Object</span><span class="p">.</span><span class="n">Instantiate</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&quot;Prefabs/Land&quot;</span><span class="p">,</span> <span class="k">typeof</span><span class="p">(</span><span class="n">GameObject</span><span class="p">)),</span> <span class="n">leftPos</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span> <span class="k">as</span> <span class="n">GameObject</span><span class="p">;</span>
            <span class="n">land</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="s">&quot;leftLand&quot;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">Vector3</span> <span class="nf">getEmptyPosition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Vector3</span> <span class="n">pos</span> <span class="p">=</span> <span class="n">landPositions</span><span class="p">[</span><span class="n">getEmptyIndex</span><span class="p">()];</span>
        <span class="n">pos</span><span class="p">.</span><span class="n">x</span> <span class="p">*=</span> <span class="n">type</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">pos</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getEmptyIndex</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnLand</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">getOnLand</span><span class="p">(</span><span class="n">ICharacterController</span> <span class="n">chracter</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">characterOnLand</span><span class="p">[</span><span class="n">getEmptyIndex</span><span class="p">()]</span> <span class="p">=</span> <span class="n">chracter</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">ICharacterController</span> <span class="nf">getOffLand</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnLand</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">getName</span><span class="p">()</span> <span class="p">==</span> <span class="n">name</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">ICharacterController</span> <span class="n">tmp</span> <span class="p">=</span> <span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">tmp</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="nf">getType</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">type</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">int</span><span class="p">[]</span> <span class="nf">getStatus</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">int</span><span class="p">[]</span> <span class="n">status</span> <span class="p">=</span> <span class="p">{</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span> <span class="p">};</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">characterOnLand</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="n">status</span><span class="p">[</span><span class="n">characterOnLand</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">getType</span><span class="p">()]++;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">}</span><span class="c1">// 0: priests, 1: Demon</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">reset</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">characterOnLand</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ICharacterController</span><span class="p">[</span><span class="m">6</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>landController的实现和上面的Controller也类似，也是实现初始化，上岸，下岸的相关函数就完成了。</p>
<hr />
<h2 id="_6">完整效果</h2>
<p><img alt="result" src="../../img/hw2-result1.png" />
<img alt="result2" src="../../img/hw2-result2.png" /></p>
<hr />
<h2 id="mvc">总结（对MVC架构开发游戏的体会）</h2>
<p>MVC架构作为一种经典的开发模式，是关注点分离的一个十分经典的体现。我们在之前的课程中，在完成一些团队项目时也有使用其作为基本架构进行开发。</p>
<p>项目使用MVC架构分离的设计，<strong>给每一个部分赋予单一的职责</strong>，使得我们在开发一个模块时不用太多地关注所使用到的模块的内部实现，我们只需要去调用相应的接口去实现自己想实现的东西，<strong>使得我们的游戏有着更低的耦合度，更方便Debug，更方便开发、迭代</strong>，就以我们上面的程序为例，在开发FirstSceneController时，我们不用怎么关注GameObject的Controller内部是怎么实现的，我们只需要知道，它给了我们什么接口，这个接口有着什么功能，知道了之后我们在FirstSceneController中直接调用接口就可以了，这不仅让个人开发更有条理，还可以使多人协作开发更加便利，难以想象一个高耦合度的中大型软件是怎么进行多人协作开发的，这样的软件一个人开发都难受，何况是多人。</p>
<p>总之，在一些中大型项目中，使用MVC架构进行开发</p>
<ul>
<li>软件耦合度低</li>
<li>模块易复用</li>
<li>生产效率高(对于中大型软件) </li>
<li>易于维护、迭代</li>
<li>有利软件工程化管理</li>
</ul>
<blockquote>
<p>但是，MVC架构不是普适的，在一些较小规模的游戏中，严格使用MVC架构对于开发的效率是有一定影响的，就像我们这次的作业🌚(逃。不过，通过这一次严格使用MVC架构开发的作业，我们对于MVC有了基本的了解，方便了我们之后使用MVC架构对其他一些更大的游戏进行开发。</p>
</blockquote>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../学习笔记2-物体的空间与运动/" title="学习笔记2-物体的空间与运动" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                学习笔记2-物体的空间与运动
              </span>
            </div>
          </a>
        
        
          <a href="../学习笔记4-游戏对象与图形基础/" title="学习笔记4-游戏对象与图形基础" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                学习笔记4-游戏对象与图形基础
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - 2019 Zhong Wenqian
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.3",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>